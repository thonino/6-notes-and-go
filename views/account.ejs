<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('./partials/links') %>
    <title>Account</title>
</head>

<body>
  <%- include('./partials/nav') %>
    <%- include('./partials/tips') %>
      <%- include('./partials/action') %>

        <div class="container mt-5">
          <div class="row justify-content-center">
            <div class="col-lg-6">
              <h1 class="text-center text-secondary mb-4">My Account</h1>

              <% if (!user) { %>
                <div class="alert alert-warning text-center">
                  Please log in to access this page!
                </div>
                <% } else { %>
                  <!-- User Information -->
                  <div class="mb-4">
                    <h3 class="fw-bold">Name: <%= user.name %>
                    </h3>
                  </div>

                  <!-- Change Email Section -->
                  <div class="mb-4">
                    <h3 class="fw-bold d-flex align-items-center">
                      Email: 
                      <span id="userEmail" class="ms-2">
                        <%= user.email %>
                      </span>
                      <button id="showInputEmail" class="btn btn-outline-secondary ms-3">
                        <i class="bi bi-pencil-fill"></i> Edit
                      </button>
                    </h3>
                    <form 
                      id="inputEmail" 
                      class="d-none mt-3 d-flex" 
                      action="/account/<%= user._id %>?_method=PUT"
                      method="POST">
                      <div class="mb-3">
                        <label for="checkPassword" class="form-label">Password</label>
                        <input type="password" class="form-control" name="checkPassword"
                          placeholder="Enter your password">
                      </div>
                      <div class="mb-3">
                        <label for="newEmail" class="form-label">New Email</label>
                        <input type="email" class="form-control" name="newEmail" placeholder="Enter your new email">
                      </div>
                      <div class="text-center">
                        <button type="submit" class="btn btn-success ">Save</button>
                      </div>
                    </form>
                  </div>

                  <!-- Change Password Section -->
                  <div class="mb-4">
                    <h3 class="fw-bold d-flex align-items-center">
                      Password
                      <button id="showInputPassword" class="btn btn-outline-secondary ms-3">
                        <i class="bi bi-pencil-fill"></i> Change
                      </button>
                    </h3>
                    <form 
                      id="inputPassword" 
                      class="d-none d-flex mt-3" 
                      action="/account/<%= user._id %>?_method=PUT"
                      method="POST"
                    >
                      <div class="mb-3">
                        <label for="checkPassword" class="form-label">Old Password</label>
                        <input type="password" class="form-control" name="checkPassword"
                          placeholder="Enter your old password">
                      </div>
                      <div class="mb-3">
                        <label for="newPassword" class="form-label">New Password</label>
                        <input type="password" class="form-control" name="newPassword"
                          placeholder="Enter your new password">
                      </div>
                      <div class="text-center">
                        <button type="submit" class="btn btn-success">Save</button>
                      </div>
                    </form>
                  </div>

                  <!-- Delete Account Section -->
                  <div class="mb-4">
                    <h3 class="fw-bold d-flex align-items-center text-danger">Delete Account
                      <button id="showInputDelete" class="btn btn-sm btn-outline-danger ms-3">
                        <i class="bi bi-trash-fill"></i> Delete
                      </button>
                    </h3>
                    <form id="inputDelete" class="d-none mt-3" action="/account/delete/<%= user._id %>?_method=DELETE"
                      method="POST">
                      <div class="mb-3">
                        <label for="checkPassword" class="form-label">Confirm Password</label>
                        <input type="password" class="form-control" name="checkPassword"
                          placeholder="Enter your password">
                      </div>
                      <div class="text-end">
                        <button type="submit" class="btn btn-danger">Delete</button>
                      </div>
                    </form>
                  </div>
                  <% } %>
            </div>
          </div>
        </div>

        <%- include('./partials/footer') %>
          <script src="/script.js"></script>
</body>

</html>